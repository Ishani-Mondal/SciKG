{"title": [{"text": "Bootstrapping a Natural Language Interface to a Cyber Security Event Collection System using a Hybrid Translation Approach", "labels": [], "entities": [{"text": "Cyber Security Event Collection", "start_pos": 48, "end_pos": 79, "type": "TASK", "confidence": 0.5332195162773132}]}], "abstractContent": [{"text": "This paper presents a system that can be used to generate Elasticsearch (database) query strings for English-speaking cyber-threat hunters, security analysts or respon-ders (agents) using a natural language interface.", "labels": [], "entities": []}, {"text": "This system relies on a hybrid translation approach combining translation memory, information extraction and text classification techniques.", "labels": [], "entities": [{"text": "information extraction", "start_pos": 82, "end_pos": 104, "type": "TASK", "confidence": 0.7917101979255676}, {"text": "text classification", "start_pos": 109, "end_pos": 128, "type": "TASK", "confidence": 0.7612585425376892}]}, {"text": "The resulting queries maybe used to (i) speedup the on-boarding of agents that are not (too) familiar with a specific, flexible database schema and (ii) collect question-to-query mappings with a view to train future models using a more robust framework (e.g. NMT).", "labels": [], "entities": []}, {"text": "The system presented in this paper supports multiple data sources, including an industry-standard knowledge base and collections of existing queries provided by individual or corporate threat hunters.", "labels": [], "entities": []}, {"text": "It allows users to ask questions about specific cybersecurity event or incident details and generates Elasticsearch query strings that can be executed against a database containing security event data.", "labels": [], "entities": []}, {"text": "This paper presents the key components of the backend system and highlights some of the user interface design choices that were made to maximize user adoption.", "labels": [], "entities": []}], "introductionContent": [{"text": "Studying the translation of natural language into SQL queries has a very long history.", "labels": [], "entities": []}, {"text": "Earlier work focused on specific databases thus requiring further customization to generalize to each new database) (Tamas and Salomie, 2016) ().", "labels": [], "entities": []}, {"text": "More recent work has explored the use of deep neural networks () especially for Wiki-based information retrieval (.", "labels": [], "entities": [{"text": "Wiki-based information retrieval", "start_pos": 80, "end_pos": 112, "type": "TASK", "confidence": 0.6461341480414072}]}, {"text": "Related areas have also been studied, such as natural language interfaces to Web APIs (, (, and dialogue-based query generation.", "labels": [], "entities": [{"text": "dialogue-based query generation", "start_pos": 96, "end_pos": 127, "type": "TASK", "confidence": 0.6235199570655823}]}, {"text": "However, little attention has been devoted to document-oriented databases with flexible schemas (e.g. Elasticsearch) that are often used as Security Information and Event Management (SIEM) systems.", "labels": [], "entities": [{"text": "Security Information and Event Management (SIEM)", "start_pos": 140, "end_pos": 188, "type": "TASK", "confidence": 0.6893942020833492}]}, {"text": "Such databases are commonly used in the context of cyber-threat hunting (or discovery) as shown for instance by the availability of the HELK stack.", "labels": [], "entities": [{"text": "cyber-threat hunting (or discovery)", "start_pos": 51, "end_pos": 86, "type": "TASK", "confidence": 0.7840299705664316}, {"text": "HELK stack", "start_pos": 136, "end_pos": 146, "type": "DATASET", "confidence": 0.8728251159191132}]}, {"text": "When hunting for advanced threats, domain experts typically have to craft complex queries.", "labels": [], "entities": []}, {"text": "Very often, however, little training data is available apart from API/schema descriptions and raw events so using a fully data-driven approach is often not practical.", "labels": [], "entities": []}, {"text": "Using interactive learning in a dialogue-based scenario may alleviate this issue (), but it is not clear that advanced users will have the patience to answer along series of questions (e.g. which user do you mean?, what devices are you talking about?) that are often required to fill slots.", "labels": [], "entities": []}, {"text": "In the present paper, we therefore present an alternative approach to tackle the problem of bootstrapping a natural language-based system for threat hunting or security incident investigation.", "labels": [], "entities": [{"text": "threat hunting or security incident investigation", "start_pos": 142, "end_pos": 191, "type": "TASK", "confidence": 0.6741026043891907}]}, {"text": "This hybrid approach is based on multiple techniques, including semantic search techniques, whereby the Source Lan-guage user input (English) is analyzed using a number of components (mostly based on rules) in order to extract entities and phrases or infer text categories that are then mapped into the Target Language's fields and terms before an actual Elasticsearch query string can be generated.", "labels": [], "entities": []}, {"text": "Using a combination of text classification and slot filling has indeed been shown to provide very competitive natural language to SQL baseline systems.", "labels": [], "entities": [{"text": "text classification", "start_pos": 23, "end_pos": 42, "type": "TASK", "confidence": 0.7274084389209747}, {"text": "slot filling", "start_pos": 47, "end_pos": 59, "type": "TASK", "confidence": 0.7403340339660645}]}, {"text": "Even though some of these rules have to be manually created, their precision is well suited to this task, especially as far the generation step is concerned to ensure that users are provided with valid queries.", "labels": [], "entities": [{"text": "precision", "start_pos": 67, "end_pos": 76, "type": "METRIC", "confidence": 0.998561441898346}]}, {"text": "The rest of the paper is organized as follows: Section 2 describes the various data sources used to create some of the linguistic components of our backend system (either manually or automatically).", "labels": [], "entities": []}, {"text": "Section 3 presents the actual system components with some examples.", "labels": [], "entities": []}, {"text": "The two final sections provide some discussion of the design choices that were made to create the user interface and outline some directions for future work.", "labels": [], "entities": []}], "datasetContent": [{"text": "In order to define the domain covered by our system, we rely primarily on an API schema file based on the OpenAPI specification.", "labels": [], "entities": [{"text": "OpenAPI specification", "start_pos": 106, "end_pos": 127, "type": "DATASET", "confidence": 0.9338878095149994}]}, {"text": "This file, which is available in JSON format, contains a full-fledged description of multiple methods and objects pertaining to an actual endpoint detection and response (EDR) system.", "labels": [], "entities": [{"text": "endpoint detection and response (EDR)", "start_pos": 138, "end_pos": 175, "type": "TASK", "confidence": 0.7851810199873788}]}, {"text": "Some of these methods are very narrow in scope (e.g. how to contain an endpoint) and can be covered by simple OpenC2 commands.", "labels": [], "entities": []}, {"text": "Others, however, can be much more complex (e.g. querying a database system to find specific security events based on several search criteria).", "labels": [], "entities": []}, {"text": "Examples of fields pertaining to the Event object include (i) an integer representing a port number, (ii) a specific type ID, whose integer value maps to a textual description (e.g. 8000 fora session event), (iii) a host name string for the client computer, (iv) a MITRE tactic string corresponding to one of the 11 tactics defined by the MITRE's ATT&CK model, or (v) an overloaded integer value mapping to multiple descriptions depending on the value of another field.", "labels": [], "entities": [{"text": "MITRE's ATT&CK model", "start_pos": 339, "end_pos": 359, "type": "DATASET", "confidence": 0.686180368065834}]}, {"text": "The overall number of fields for the Event object is very large (more than 500) but the actual number of fields will vary depending on the type of event (e.g. a file reputation request event or a session event).", "labels": [], "entities": []}, {"text": "Such events tend to include a few dozens fields so the goal of this system is to cover those that appear the most frequently in the data (raw events).", "labels": [], "entities": []}, {"text": "While the previous section focused on specific fields and associated values, threat hunters often need to craft more advanced queries whose textual mappings do not include specific field values or descriptions.", "labels": [], "entities": [{"text": "threat hunters", "start_pos": 77, "end_pos": 91, "type": "TASK", "confidence": 0.8048676252365112}]}, {"text": "For instance, a question such as show me the outbound traffic occurring on non-standard ports has to be matched with: In this example, the phrase non-standard port cannot be found in the API Schema but obviously a domain expert is able to associate it with all ports apart from 80 and 443 in the context of HTTP traffic.", "labels": [], "entities": []}, {"text": "The same applies to the phrase outbound traffic.", "labels": [], "entities": []}, {"text": "Since the number of descriptions/queries pairs is quite small in this dataset (less than 50), these complex mappings cannot be learnt using a data-driven approach.", "labels": [], "entities": []}, {"text": "However, we can try and detect some of these phrases in the user input and either (i) apply a translation memory technique to retrieve partial (or fuzzy) matches or (ii) offer suggestions via the user interface.", "labels": [], "entities": []}, {"text": "These two approaches will be described in sections 3.1 and 4 respectively.", "labels": [], "entities": []}, {"text": "The MITRE cyber-threat intelligence (CTI) dataset provides some textual information for each of the 223 techniques defined in the ATT&CK model.", "labels": [], "entities": [{"text": "MITRE cyber-threat intelligence (CTI) dataset", "start_pos": 4, "end_pos": 49, "type": "DATASET", "confidence": 0.6812811579023089}, {"text": "ATT&CK model", "start_pos": 130, "end_pos": 142, "type": "DATASET", "confidence": 0.6289816051721573}]}, {"text": "We leverage this dataset in two ways: First, we use the technique names to detect their mentions as entities in user input (as described in Section 3.2).", "labels": [], "entities": []}, {"text": "Second, we use additional information in order to train a multi-class text categorizer.", "labels": [], "entities": []}, {"text": "This information includes a brief description of the techniques as well as guidance on how to detect and mitigate against such attacks.", "labels": [], "entities": []}, {"text": "Some examples of malware or attack group using this technique may also be provided.", "labels": [], "entities": []}, {"text": "All of this information can be parsed and split into sentences.", "labels": [], "entities": []}, {"text": "The initial data set, referred to as mitre-6.5k, is quite small (6500 sentences) and not very balanced as most techniques (140/223) (classes) contain less than 23 sentences.", "labels": [], "entities": []}, {"text": "In order to deal with this data shortage issue, we can supplement the training data with sentences extracted from external references (e.g. web pages, PDF documents) cited in the MITRE pages.", "labels": [], "entities": [{"text": "MITRE pages", "start_pos": 179, "end_pos": 190, "type": "DATASET", "confidence": 0.9173926115036011}]}, {"text": "This strategy allows us to increase the size of the training data to about 60K sentences (referred to as mitre60k).", "labels": [], "entities": []}, {"text": "This text classifier will be presented in Section 3.5.", "labels": [], "entities": []}, {"text": "While the previous two datasets are directly associated with the EDR system of interest, other datasets could be relevant to users of that system.", "labels": [], "entities": [{"text": "EDR system", "start_pos": 65, "end_pos": 75, "type": "DATASET", "confidence": 0.8781303465366364}]}, {"text": "For instance, the Sigma project contains a number of detection rules that maybe used to query security information and event management system logs.", "labels": [], "entities": []}, {"text": "Some experienced cyber-security professionals may actually be more familiar with these rules (and their default fields) than the schema presented in section 2.1.", "labels": [], "entities": []}, {"text": "Similarly, the Lolbas project makes a number of detection rules available to identify anomalous or suspicious usage of legitimate system or administration tools.", "labels": [], "entities": [{"text": "Lolbas project", "start_pos": 15, "end_pos": 29, "type": "DATASET", "confidence": 0.9119788110256195}]}, {"text": "Such rules are associated with a description and/or a title whose words could appear in user input.", "labels": [], "entities": []}, {"text": "These rules from these datasets are therefore parsed by our system and made available to users via interactive suggestions and partial matching.", "labels": [], "entities": []}, {"text": "One of the challenges with these datasets is that the queries or commands they expose are not fully compatible with our target Elasticsearch index.", "labels": [], "entities": []}, {"text": "For instance, the following Lolbas command includes a Command field that must be mapped to a process.cmd line field: Command: rundll32.exe shdocvw.dll,OpenURL \"C:\\test\\calc.url\" This example also includes a test parameter \"C:\\test\\calc.url\" that would have to be replaced with a proper value in a successful query.", "labels": [], "entities": []}, {"text": "In order to deal with this problem, this test parameter can be easily filtered out by parsing the command in order to generate the following query: process.cmd_line:[\"rundll32.exe\" AND \"shdocvw.dll,OpenURL\"] Interestingly, both of these data sources also include references to MITRE technique IDs in their rules.", "labels": [], "entities": []}, {"text": "This is useful for two reasons.", "labels": [], "entities": []}, {"text": "First, when the query includes fields that cannot easily be mapped (e.g. Event ID 13: RegistryEvent (Value Set) generated by Sysmon (Russinovich and Garnier, 2019)), the MITRE technique ID maybe suggested to the user who would then be able to filter out the results interactively.", "labels": [], "entities": []}, {"text": "Second, we can use 420 labelled sentences from these datasets (referred to test-set) to evaluate our system's text classification component trained on the actual MITRE data.", "labels": [], "entities": [{"text": "text classification", "start_pos": 110, "end_pos": 129, "type": "TASK", "confidence": 0.7154066562652588}, {"text": "MITRE data", "start_pos": 162, "end_pos": 172, "type": "DATASET", "confidence": 0.9338565170764923}]}], "tableCaptions": []}